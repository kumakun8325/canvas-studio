# Canvas Studio - 要件定義書

## 1. プロジェクト概要

### 1.1 目的
Canvaライクなスライド/デザインエディタをWebアプリとして開発する。

### 1.2 ターゲットユーザー
- プレゼン資料を作成するユーザー
- 名刺・チラシなどの印刷物を作成するユーザー
- 画像コンテンツを編集・エクスポートするユーザー

### 1.3 開発環境
- OS: WSL2 (Ubuntu)
- Node.js: v20.x
- 作業ディレクトリ: ~/projects/canvas-studio

---

## 2. 技術スタック

| カテゴリ | 技術 |
|---------|------|
| ビルドツール | Vite |
| フレームワーク | React + TypeScript |
| キャンバス | Fabric.js 6.x |
| 状態管理 | Zustand |
| スタイリング | Tailwind CSS v4 |
| 認証 | Firebase Authentication |
| データベース | Firestore |
| ストレージ | Firebase Storage |

---

## 3. 機能要件

### Phase 1: 基本キャンバス

| ID | 要件 | 優先度 |
|----|------|--------|
| F-001 | 白紙のキャンバスを表示できる | 必須 |
| F-002 | 四角形を追加できる | 必須 |
| F-003 | 円を追加できる | 必須 |
| F-004 | テキストを追加できる | 必須 |
| F-005 | オブジェクトを選択できる | 必須 |
| F-006 | オブジェクトを移動できる | 必須 |
| F-007 | オブジェクトをリサイズできる | 必須 |
| F-008 | Deleteキーでオブジェクトを削除できる | 必須 |

### Phase 2: スライド管理

| ID | 要件 | 優先度 |
|----|------|--------|
| F-009 | スライド一覧を表示できる | 必須 |
| F-010 | スライドを追加できる | 必須 |
| F-011 | スライドを削除できる | 必須 |
| F-012 | スライドを切り替えできる | 必須 |
| F-013 | スライドのサムネイルを表示できる | 必須 |
| F-014 | スライドをドラッグで並べ替えできる | 必須 |

### Phase 3: Undo/Redo（pdfeditor参考）

| ID | 要件 | 優先度 |
|----|------|--------|
| F-015 | Ctrl+Z でUndoできる | 必須 |
| F-016 | Ctrl+Y / Ctrl+Shift+Z でRedoできる | 必須 |
| F-017 | オブジェクト追加/削除/移動をUndoできる | 必須 |
| F-018 | スライド操作をUndoできる | 必須 |

### Phase 4: Firebase連携

| ID | 要件 | 優先度 |
|----|------|--------|
| F-019 | Googleアカウントでログインできる | 必須 |
| F-020 | プロジェクトをFirestoreに保存できる | 必須 |
| F-021 | プロジェクトをFirestoreから読み込める | 必須 |
| F-022 | 画像をFirebase Storageにアップロードできる | 必須 |
| F-023 | 自動保存機能 | 必須 |

### Phase 5: 追加機能

| ID | 要件 | 優先度 |
|----|------|--------|
| F-024 | ローカル画像をキャンバスに追加できる | 必須 |
| F-025 | URL画像をキャンバスに追加できる | 任意 |
| F-026 | Ctrl+C でオブジェクトをコピーできる | 必須 |
| F-027 | Ctrl+V でオブジェクトをペーストできる | 必須 |
| F-028 | オブジェクトを前面に移動できる | 必須 |
| F-029 | オブジェクトを背面に移動できる | 必須 |
| F-030 | 複数オブジェクトをグループ化できる | 任意 |
| F-031 | グループを解除できる | 任意 |

### Phase 6: テンプレート

| ID | 要件 | 優先度 |
|----|------|--------|
| F-032 | 16:9（1920x1080）テンプレートを選択できる | 必須 |
| F-033 | A4縦（210x297mm, 2480x3508px）テンプレートを選択できる | 必須 |
| F-034 | A4横（297x210mm）テンプレートを選択できる | 必須 |
| F-035 | 名刺サイズ（91x55mm）テンプレートを選択できる | 必須 |
| F-036 | カスタムサイズを指定できる | 任意 |
| F-037 | テンプレートギャラリーから選択できる | 任意 |

### Phase 7: エクスポート

| ID | 要件 | 優先度 |
|----|------|--------|
| F-038 | PNGでエクスポートできる | 必須 |
| F-039 | JPEGでエクスポートできる | 必須 |
| F-040 | PDFでエクスポートできる | 必須 |
| F-041 | CMYK変換してPDFエクスポートできる（pdfeditor参考） | 必須 |
| F-042 | 名刺用PDF（トンボ付き）を作成できる | 必須 |
| F-043 | 塗り足し（3mm）を設定できる | 必須 |

---

## 4. 非機能要件

### 4.1 ユーザビリティ

| ID | 要件 |
|----|------|
| NF-001 | モダンで直感的なUI |
| NF-002 | ダークモード対応 |
| NF-003 | レスポンシブデザイン（デスクトップ優先） |

### 4.2 パフォーマンス

| ID | 要件 |
|----|------|
| NF-004 | 20枚程度のスライドを快適に編集できる |
| NF-005 | 大きな画像（10MB）を扱える |

### 4.3 セキュリティ

| ID | 要件 |
|----|------|
| NF-006 | Firebaseセキュリティルールで認証ユーザーのみアクセス可能 |

---

## 5. pdfeditorとの関係

### 5.1 統合戦略
**B: コード参考・個別実装**を採用

### 5.2 参考にする機能

| 機能 | pdfeditorのファイル | 備考 |
|------|---------------------|------|
| CMYK変換 | Phase 35関連ファイル | ロジックをほぼ流用 |
| 名刺PDF | Phase 38（未実装） | 両プロジェクトで個別実装 |
| Undo/Redo | UndoManager.ts | 設計思想を参考 |
| コピペ | Phase 14関連 | Fabric.jsに合わせて再実装 |

---

## 6. 開発フェーズ

| Phase | 機能 | 見積もり |
|-------|------|----------|
| 1 | 基本キャンバス | 2日 |
| 2 | スライド管理 | 2日 |
| 3 | Undo/Redo | 1日 |
| 4 | Firebase連携 | 2日 |
| 5 | 追加機能（コピペ等） | 2日 |
| 6 | テンプレート | 1日 |
| 7 | エクスポート | 3日 |
| **合計** | | **約13日** |

---

## 7. 用語定義

| 用語 | 説明 |
|------|------|
| スライド | 1ページ分のキャンバス |
| プロジェクト | スライドの集合体 |
| オブジェクト | キャンバス上の図形・テキスト・画像 |
| テンプレート | 事前定義されたキャンバスサイズ |
| トンボ（トリムマーク） | 印刷時の裁断位置を示すマーク |
