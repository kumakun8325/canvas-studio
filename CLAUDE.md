# CLAUDE.md

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Canvas Studio - Fabric.jsã‚’ä½¿ç”¨ã—ãŸãƒ–ãƒ©ã‚¦ã‚¶ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| Category | Technology |
|----------|------------|
| Framework | React 19 + TypeScript |
| Build | Vite |
| Canvas | Fabric.js 6.x |
| State | Zustand |
| Styling | Tailwind CSS 4 |
| Backend | Firebase |
| Testing | Vitest + Testing Library |

## é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯SDDï¼ˆä»•æ§˜é§†å‹•é–‹ç™ºï¼‰+ ãƒãƒ«ãƒAIåˆ†æ¥­ä½“åˆ¶ã§é–‹ç™ºã—ã¾ã™ã€‚
ã‚¯ã‚©ãƒ¼ã‚¿æœ€é©åŒ–ã®ãŸã‚ã€å„ãƒ•ã‚§ãƒ¼ã‚ºã§é©åˆ‡ãªãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚

### ãƒ¢ãƒ‡ãƒ«å‡¡ä¾‹

| ã‚¢ã‚¤ã‚³ãƒ³ | ãƒ¢ãƒ‡ãƒ« | ç”¨é€” | ã‚³ã‚¹ãƒˆ |
|----------|--------|------|--------|
| ğŸŸ£ | Opus | è¤‡é›‘ãªè¨­è¨ˆãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ | Proæ¶ˆè²» |
| ğŸŸ¡ | Sonnet | è¨­è¨ˆæ”¹å–„ãƒ»åˆ¤æ–­ãƒ»æ‰¿èª | Proæ¶ˆè²»ï¼ˆè»½é‡ï¼‰ |
| ğŸŸ¢ | GPT-5.2-Codex | ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»åˆ†æ | Copilot Pro (1 PR/å›) |
| ğŸ”µ | GLM-4.7 | å®Ÿè£…ãƒ»è‡ªå·±ç‚¹æ¤œ | Proæ¶ˆè²»ãªã— |

### GPT-5.2-Codex å®Ÿè¡Œç’°å¢ƒ

| ç”¨é€” | ãƒ„ãƒ¼ãƒ« | reasoning effort |
|------|--------|------------------|
| è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ (Step 2) | `copilot` CLI (ãƒ­ãƒ¼ã‚«ãƒ«) | xhigh |
| PRãƒ¬ãƒ“ãƒ¥ãƒ¼ (Phase 3-4) | GitHub Actions (è‡ªå‹•) | medium |

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ¸ˆã¿:**
- `~/.copilot/config.json` - xhigh ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
- `.github/workflows/codex-review.yml` - PRè‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼

### Phase 1: è¨­è¨ˆ

```
Step 1: è¦ä»¶ãƒ»è¨­è¨ˆ        â†’ ğŸŸ£ Opus
Step 2: è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼      â†’ ğŸŸ¢ GPT-5.2-Codex (xhigh) via copilot CLI
Step 3: è¨­è¨ˆæ”¹å–„          â†’ ğŸŸ¡ Sonnet (Extended Thinking OFF)
```

- Step 1: è¦ä»¶å®šç¾©ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆï¼ˆOpusã®æ·±ã„æ¨è«–ãŒå¿…è¦ï¼‰
- Step 2: `/review-design` ã‚³ãƒãƒ³ãƒ‰ã§è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆCopilot CLIï¼‰
- Step 3: æŒ‡æ‘˜ãŒæ˜ç¢ºãªã®ã§Sonnetã§æ”¹å–„å¯èƒ½

### Phase 2: å®Ÿè£…ï¼ˆä¸¦åˆ—å‡¦ç†ï¼‰

```
Step 4: ã‚¿ã‚¹ã‚¯Dispatch    â†’ ğŸŸ£ Opus (ãƒ­ãƒ¼ã‚«ãƒ«)
        â†“ /dispatch ã‚³ãƒãƒ³ãƒ‰
        â†“ GitHub Issues è‡ªå‹•ä½œæˆ
        â†“ Batch workflow è‡ªå‹•ãƒˆãƒªã‚¬ãƒ¼
        â†“
Step 5: ä¸¦åˆ—å®Ÿè£…          â†’ ğŸ”µ GLM-4.7 (GitHub Actions)
Step 6: è‡ªå·±ç‚¹æ¤œ          â†’ ğŸ”µ GLM-4.7 (GitHub Actions)
```

- Step 4: `/dispatch` ã§è¨­è¨ˆã‹ã‚‰ã‚¿ã‚¹ã‚¯ã‚’IssueåŒ–ã—ã€ä¸¦åˆ—å®Ÿè£…ã‚’è‡ªå‹•èµ·å‹•
- Step 5: å„ã‚¿ã‚¹ã‚¯ãŒGitHub Actionsä¸Šã§ä¸¦åˆ—å®Ÿè¡Œï¼ˆæœ€å¤§5ä¸¦åˆ—ï¼‰
- Step 6: å®Ÿè£…è€…è‡ªèº«ãŒã‚»ãƒ«ãƒ•ãƒ¬ãƒ“ãƒ¥ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /dispatch                                â”‚
â”‚  ã‚¿ã‚¹ã‚¯: A, B, C ã‚’ä¸¦åˆ—å®Ÿè£…              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Issue #1 â”‚ Issue #2 â”‚ Issue #3 â”‚
â”‚ ğŸ”µGLM4.7â”‚ ğŸ”µGLM4.7â”‚ ğŸ”µGLM4.7â”‚  â† ä¸¦åˆ—å®Ÿè¡Œ
â”‚ Task A   â”‚ Task B   â”‚ Task C   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
         å„ã‚¿ã‚¹ã‚¯ãŒPRä½œæˆ
```

### Phase 3: ãƒ¬ãƒ“ãƒ¥ãƒ¼

```
Step 7: å®Ÿè£…ãƒã‚§ãƒƒã‚¯      â†’ ğŸŸ¢ GPT-5.2-Codex (medium) via GitHub Actions
Step 8: ä¿®æ­£Issueä½œæˆ     â†’ ğŸŸ¡ Sonnet (å¿…è¦æ™‚ã®ã¿)
```

- Step 7: PRãŒopenã•ã‚Œã‚‹ã¨è‡ªå‹•ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ`codex-review.yml`ï¼‰
- Step 8: å•é¡ŒãŒã‚ã‚Œã°Issueä½œæˆ

### Phase 4: æœ€çµ‚ãƒ¬ãƒ“ãƒ¥ãƒ¼

```
Step 9: æœ€çµ‚ãƒã‚§ãƒƒã‚¯
  - è©³ç´°åˆ†æ             â†’ ğŸŸ¢ GPT-5.2-Codex (xhigh) via copilot CLI
  - åˆ¤æ–­ãƒ»æ‰¿èª           â†’ ğŸŸ¡ Sonnet

ã€ä¾‹å¤–ã€‘é‡å¤§ãªè¨­è¨ˆå¤‰æ›´ãŒå¿…è¦ãªå ´åˆã®ã¿ â†’ ğŸŸ£ Opus
```

- ãƒãƒ¼ã‚¸å‰ã« `copilot /review` ã§æœ€çµ‚ç¢ºèªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- CodexãŒè©³ç´°åˆ†ææ¸ˆã¿ãªã®ã§Sonnetã§åˆ¤æ–­å¯èƒ½
- è¨­è¨ˆã®æ ¹æœ¬çš„ãªè¦‹ç›´ã—ãŒå¿…è¦ãªå ´åˆã®ã¿Opusã‚’ä½¿ç”¨

### ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

| Phase | Commands | Description |
|-------|----------|-------------|
| è¨­è¨ˆ | `/design`, `/review-design` | è¦ä»¶å®šç¾©ãƒ»è¨­è¨ˆ |
| å®Ÿè£… | `/dispatch` | ã‚¿ã‚¹ã‚¯ã‚’IssueåŒ–ã—ä¸¦åˆ—å®Ÿè£…ã‚’è‡ªå‹•èµ·å‹• |
| å®Ÿè£… | `/start`, `/finish` | æ‰‹å‹•å®Ÿè£…ç”¨ |
| ãƒ¬ãƒ“ãƒ¥ãƒ¼ | `/review`, `/verify` | ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ¤œè¨¼ |

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### TypeScript

- strict modeæœ‰åŠ¹
- `any`ç¦æ­¢ã€å¿…ãšå‹å®šç¾©
- å‹ã¯`types/`ã«é›†ç´„

### React

- Functional Components + Hooks ã®ã¿
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¯`hooks/`ã«é…ç½®
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯1ãƒ•ã‚¡ã‚¤ãƒ«1ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### å‘½åè¦å‰‡

| å¯¾è±¡ | è¦å‰‡ | ä¾‹ |
|------|------|-----|
| å¤‰æ•°ãƒ»é–¢æ•° | camelCase | `canvasWidth`, `handleClick` |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | PascalCase | `ToolBar`, `CanvasEditor` |
| å‹ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | PascalCase | `CanvasObject`, `ExportOptions` |
| å®šæ•° | UPPER_SNAKE_CASE | `DEFAULT_WIDTH`, `MAX_ZOOM` |
| ãƒ•ã‚¡ã‚¤ãƒ« (ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ) | PascalCase | `ToolBar.tsx` |
| ãƒ•ã‚¡ã‚¤ãƒ« (ãã®ä»–) | camelCase | `useCanvas.ts`, `exportService.ts` |

### ã‚¤ãƒ³ãƒãƒ¼ãƒˆé †åº

```typescript
// 1. React
import { useState, useEffect } from 'react'

// 2. å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
import { fabric } from 'fabric'

// 3. å†…éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (çµ¶å¯¾ãƒ‘ã‚¹)
import { useCanvasStore } from '@/stores/canvasStore'

// 4. ç›¸å¯¾ãƒ‘ã‚¹
import { Button } from './Button'
```

## ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆ

```bash
npm install       # ä¾å­˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm run dev       # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run build     # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
npm run test      # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ (watch mode)
npm run test:run  # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ (single run)
npm run test:coverage  # ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
npm run lint      # ESLintå®Ÿè¡Œ
```

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
src/
â”œâ”€â”€ components/   # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ constants/    # å®šæ•°å®šç¾©
â”œâ”€â”€ hooks/        # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”œâ”€â”€ lib/          # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ pages/        # ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ services/     # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ stores/       # Zustand stores
â”œâ”€â”€ test/         # ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â””â”€â”€ types/        # å‹å®šç¾©
```

## é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

| File | Description |
|------|-------------|
| `.kiro/steering/requirements.md` | è¦ä»¶å®šç¾©æ›¸ |
| `.kiro/steering/design.md` | è¨­è¨ˆæ›¸ |
| `.kiro/steering/tasks.md` | ã‚¿ã‚¹ã‚¯ç®¡ç† |
| `docs/handoff.md` | AIé–“å¼•ãç¶™ã |
| `.claude/rules/` | ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ« |
| `.claude/memory/` | ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜æ†¶ |
