name: Auto Retry Failed

on:
  workflow_run:
    workflows:
      - "Auto Apply Review Suggestions"
      - "Auto Code Review"
      - "Auto Merge Retry"
      - "Batch Review Notify"
      - "Claude Auto-Continue"
      - "Claude Batch Implementation"
      - "Claude Code Responder"
      - "CodeQL Security Scan"
      - "Codex Review"
      - "Project Integration"
      - "Release Automation"
      - "Task Completion"
      - "Test"
    types: [completed]

jobs:
  handle-failure:
    if: github.event.workflow_run.conclusion == 'failure'
    permissions:
      actions: write
      issues: write
      pull-requests: write
      contents: read
    uses: ./.github/workflows/retry-failed-handler.yml
    with:
      run_id: ${{ github.event.workflow_run.id }}
      workflow_name: ${{ github.event.workflow_run.name }}
      head_branch: ${{ github.event.workflow_run.head_branch }}
      run_attempt: ${{ github.event.workflow_run.run_attempt }}
      repository: ${{ github.repository }}
      html_url: ${{ github.event.workflow_run.html_url }}
    secrets: inherit
